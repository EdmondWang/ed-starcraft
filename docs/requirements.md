## 1. 项目概述

### 1.1 项目背景

本项目是一个**类星际争霸（RTS 实时战略）**的网页游戏，运行于 Chrome 浏览器中。  
游戏核心体验包括：资源采集、基地建设、单位生产、战术操作与对战决策，目标是在浏览器端提供流畅、即时反馈的 RTS 体验。

### 1.2 项目目标

- **核心目标**：实现一款可在桌面 Chrome 浏览器中稳定运行的、玩法类似《星际争霸》的 RTS 游戏原型。
- **体验目标**：
  - 提供基础的即时操作体验：选择、移动、攻击等。
  - 支持多单位、多建筑的基本运营与战斗。
  - 在较低配置的机器上也能保持流畅帧率（目标 60 FPS，最低可接受 30 FPS）。
- **产品目标**：
  - 作为后续扩展（更丰富的种族、AI 对战、联机模式等）的基础框架。
  - 为后续的游戏平衡性调整与内容迭代提供良好的代码结构与模块化设计。

### 1.3 运行环境

- **浏览器**：以 Chrome 最新稳定版本为主（优先支持桌面端 Windows / macOS）。
- **分辨率**：优先支持 1920x1080，兼容 1366x768 及以上分辨率。
- **输入设备**：键鼠操作（不考虑触屏）。

## 2. 目标用户与使用场景

### 2.1 目标用户

- **RTS 爱好者**：熟悉《星际争霸》等 RTS 游戏的玩家。
- **开发/技术同好**：对 Web 技术实现 RTS 游戏感兴趣的前端/游戏开发者。

### 2.2 使用场景

- 用户在 Chrome 浏览器中打开游戏页面，在无需安装额外客户端的前提下直接体验 RTS 游戏。
- 适合作为技术展示 Demo 或个人项目作品集的一部分。

## 3. 范围与不在本期范围内

### 3.1 本期（V1）范围

- 单人本地对战原型（例如：玩家 vs 简单 AI，或仅沙盒模式）。
- **原创阵营设定**：先实现 2 个种族/阵营：
  - 神族（高科技、高爆发，偏少量精英单位）。
  - 虫族（群体作战、快速繁殖，偏大量低成本单位）。
- 每个种族至少包含：
  - 若干基础建筑：主基地、资源采集建筑、防御建筑等。
  - 若干基础单位：工人、基础战斗单位（近战/远程等）。
- 基础地图场景和资源点布局。
- 基本 UI：小地图/主视图、资源条、单位/建筑信息面板、简单操作面板。
- 基本游戏循环：开始 → 运营/对战 → 获胜/失败判断 → 结束。

### 3.2 暂不在本期范围内（可作为后续版本规划）

- 完整多人联机对战。
- 完整战役/关卡系统与剧情。
- 完整平衡性调整和庞大单位/科技树。
- 复杂 AI（如多难度层级、学习型 AI）。
- 重放、观战系统。

## 4. 技术栈与总体架构

### 4.1 技术栈

- **渲染层**：`pixi.js`
  - 用于 2D 场景渲染、精灵管理、图层与特效。
- **UI 层**：`React`
  - 用于构建游戏外壳 UI（菜单、HUD、面板等）。
  - 管理与展示游戏状态（资源数值、单位信息、游戏设置等）。
- **状态管理**：`zustand`
  - 管理全局游戏 UI 状态、设置、轻量级全局数据（如当前界面状态、用户配置等）。
- **数据获取与缓存**：`react-query`
  - 用于异步数据请求与缓存（如后续有远程配置、排行榜、账号数据等场景）。
- **路由**：`react-router-dom`
  - 管理主菜单、游戏页面、设置、教程等多页面/多状态的路由切换。
- **构建工具**：`Vite`
  - 负责开发环境构建、热更新与生产打包。

> 注：后续如引入更多技术（例如状态管理库、路由、构建工具等），可在此章节补充。

### 4.2 逻辑分层（建议）

- **游戏内核（Game Core）**
  - 单位、建筑、地图、资源、战斗系统等与 UI/渲染无关的纯逻辑。
- **渲染层（Render Layer, pixi.js）**
  - 将游戏内核的状态映射为可视对象（精灵、动画、特效）。
- **UI 层（UI Layer, React）**
  - 游戏菜单、HUD（资源条、人口、时间）、侧边栏信息、设置界面等。
- **交互层（Input Layer）**
  - 鼠标/键盘输入，选择框、右键命令、快捷键等，将用户操作转换为游戏内核指令。

## 5. 功能需求

### 5.1 游戏基础框架

- **加载与启动**
  - 游戏加载时显示 Loading 界面（简单进度或提示）。
  - 能正确初始化 pixi.js 渲染器、场景、游戏内核状态。
- **主菜单**
  - 提供「开始游戏」「教程」「读取存档」「设置」「退出/返回」等基本入口（退出可为返回主菜单）。

### 5.2 地图与资源系统

- **地图**
  - 至少 1 张预置地图，包含：
    - 主基地出生点。
    - 多个资源点（矿物、气体等，可简化为单一资源类型）。
  - 支持摄像机在地图范围内平移/缩放（V1 最低支持平移）。
- **资源采集**
  - 工人单位可在资源点进行采集。
  - 资源数在 UI 中实时显示（如：矿物、气体等，可先实现一种资源）。

### 5.3 单位与建筑

- **单位类型（V1 建议）**
  - 工人：采集资源、建造建筑。
  - 基础战斗单位：如步兵，具备攻击能力。
- **建筑类型（V1 建议）**
  - 主基地：生产工人，作为游戏关键建筑之一。
  - 军事建筑：生产基础战斗单位。
  - 防御建筑（可选）：固定位置防御单位/塔。
- **属性与状态**
  - 单位/建筑应具备：
    - 生命值、（可选：护盾/装甲）、攻击力、攻击范围、移动速度等。
  - 支持基础状态变化：
    - 选中、高亮、受伤（血条变化）、死亡/摧毁。

### 5.4 操作与战斗系统

- **选择与命令**
  - 鼠标左键点击选择单位/建筑（支持单选，V1 可暂不实现框选，多选可以作为加分）。
  - 鼠标右键执行命令：
    - 对地面：移动到目标地点。
    - 对敌方单位/建筑：切换为攻击命令。
  - 支持点击生产按钮/快捷键在建筑中排队生产单位（简化为无生产时间或有简化冷却）。
- **战斗与伤害**
  - 单位自动寻路到攻击目标位置（V1 可采用简单寻路/直线移动 + 碰撞简化）。
  - 攻击触发后，对目标造成伤害并更新生命值。
  - 当生命值归零时，目标死亡并从场景和游戏内核中移除。

### 5.5 UI 与 HUD

- **资源面板**
  - 显示当前玩家的资源数量（矿物等）。
- **单位/建筑信息面板**
  - 选中对象后显示：
    - 名称、当前生命值/最大生命值。
    - 基础属性（攻击/防御等，可适度精简）。
- **小地图（可选，若 V1 难度较高可延期）**
  - 显示全局地图缩略图。
  - 显示本方/敌方单位大致位置（可简化为仅本方）。

### 5.6 游戏流程与状态管理

- **游戏状态**
  - 至少包含：主菜单、教程中、游戏中、暂停、游戏结束。
- **游戏结束条件**
  - 当玩家主基地被摧毁（或全部建筑/单位被清除）时判定为失败。
  - 当敌方关键建筑/单位被摧毁时判定为胜利。
  - 显示简单结束界面（「胜利/失败」「返回主菜单」按钮）。
- **暂停**
  - 支持手动暂停（如通过 ESC），停止游戏内核更新与动画（或降低更新频率）。
 - **存档/读档**
  - 支持在游戏中手动触发「存档」，保存当前游戏进度（至少包含：种族选择、资源数量、单位/建筑状态、游戏时间等核心信息）。
  - 支持从主菜单选择「读取存档」恢复最近一次存档进度。
  - 存档存储位置与方式（例如本地存储）可在技术设计阶段进一步细化。
 - **内置教程/新手引导**
  - 提供至少 1 个教程关卡或引导流程，覆盖基础操作：
    - 摄像机移动、选中单位/建筑、移动命令、攻击命令、基本生产操作。
  - 教程过程中通过 UI 提示/步骤引导玩家完成指定任务（如「选择工人并采集资源」）。

## 6. 非功能性需求

### 6.1 性能

- 在普通桌面 Chrome 浏览器中，目标在中等数量单位下保持：
  - **目标帧率**：60 FPS。
  - **最低可接受帧率**：30 FPS。
- 对象数量与特效应有合理上限，避免明显卡顿或掉帧。

### 6.2 可维护性与扩展性

- 游戏内核（逻辑）与渲染/UI 尽量解耦，方便：
  - 后续增加新单位/建筑类型。
  - 替换或扩展渲染层与 UI 功能。
- 模块划分清晰（单位系统、战斗系统、资源系统、UI 系统等），避免逻辑散落各处。

### 6.3 兼容性

- 优先保证在最新版 Chrome 的正常运行。
- 对其他 Chromium 内核浏览器（Edge 等）的兼容可以作为后续优化目标。

### 6.4 美术风格

- 整体美术风格暂定为**写实风格**：
  - 单位、建筑与场景尽量贴近现实/科幻写实质感。
  - 特效（爆炸、能量光束等）在写实基础上适度夸张。

## 7. 版本规划（初稿）

### 7.1 V0.1 原型版

- 搭建基础项目结构（React + pixi.js 集成）。
- 实现：
  - 地图加载与渲染。
  - 单一单位类型的移动与简单攻击逻辑。
  - 基础 UI（资源显示、单位血条）。

### 7.2 V1.0 单人对战基础版

- 完整的资源采集与消耗逻辑。
- 至少 2 种单位 + 2~3 种建筑。
- 简单 AI 对手（或沙盒模式）。
- 胜负判断与游戏结束界面。
- 基本设置界面（音量开关、简单画质选项等）。

### 7.3 后续版本（待定）

- 地图编辑/多地图支持。
- 更多单位、建筑与科技系统。
- AI 难度与行为增强。
- 多人联机（长远规划）。

## 8. 开放问题与待确认事项

以下内容尚未最终确定，后续可在设计阶段逐步补充或调整：

- 是否需要引入第 3 个或更多原创阵营，以及各自的特色机制？
- 存档/读档的具体技术实现方式与存储结构（如多存档槽、自动存档等）。
- 教程/新手引导的深度与形式（仅基础操作，还是包含简单剧情与任务系统）。
- 写实风格下的具体美术方向（偏硬科幻 / 军事写实 / 黑暗风等）。

> 本文档为初版需求说明，后续可根据实际开发进展与反馈迭代更新。


